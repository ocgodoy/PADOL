{"ast":null,"code":"var _jsxFileName = \"/Users/oceanegodoy/Documents/ENSEIRB-MATMECA/3A/PADOL/frontend/src/components/auth/login.js\";\nimport React, { Component } from \"react\";\nimport { Button, Form, Grid, Message, Segment, Header } from \"semantic-ui-react\";\nimport { Redirect } from \"react-router-dom\";\nimport { ApiClient } from \"../../utils/ApiClient\";\nimport Auth from \"../../utils/Auth\";\nimport { connect } from \"react-redux\";\nimport { authenticateUser } from \"../../actions/user\";\n\nfunction validateEmail(email) {\n  var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return re.test(String(email).toLowerCase());\n}\n\nclass Login extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      email: null,\n      password: null,\n      loginSuccessful: false,\n      error: null,\n      user: null,\n      authenticated: false\n    };\n\n    this.handleChange = event => {\n      const {\n        email,\n        password\n      } = event.target;\n\n      switch (event.target.name) {\n        case \"email\":\n          this.setState({\n            email: event.target.value\n          });\n          break;\n\n        case \"password\":\n          this.setState({\n            password: event.target.value\n          });\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    this.validate = async () => {\n      const {\n        email,\n        password\n      } = this.state;\n\n      if (!email && !validateEmail(email)) {\n        return Promise.reject(\"Please provide a correct email\");\n      }\n\n      if (!password) {\n        return Promise.reject(\"Please provide a password\");\n      }\n\n      return Promise.resolve();\n    };\n\n    this.handleSubmit = event => {\n      const {\n        email,\n        password,\n        error\n      } = this.state;\n      const self = this;\n      this.validate().then(() => {\n        ApiClient.login(email, password).then(res => {\n          if (res.data.success) {\n            Auth.saveToken(res.data.token);\n          }\n\n          self.setState({\n            loginSuccessful: res.data.success,\n            error: res.data.message\n          });\n        }).catch(e => this.setState(() => ({\n          error: e.data.message,\n          loginSuccessful: false\n        })));\n      }).catch(e => {\n        this.setState({\n          error: e\n        });\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.props.dispatch(authenticateUser());\n  }\n\n  componentWillReceiveProps(nextProps) {\n    console.log(\"************ Login page componentWillReceiveProps **************\", nextProps);\n\n    if (nextProps.authenticated === true) {\n      this.setState({\n        authenticated: true\n      });\n    }\n  }\n\n  render() {\n    const {\n      loginSuccessful,\n      user,\n      authenticated\n    } = this.state;\n\n    if (loginSuccessful || authenticated) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/account\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 14\n        }\n      });\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"login-form\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        textAlign: \"center\" // style={{ height: \"100%\" }}\n        ,\n        verticalAlign: \"middle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Grid.Column, {\n        style: {\n          maxWidth: 450\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Header, {\n        as: \"h3\",\n        textAlign: \"center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 15\n        }\n      }, \"Login form\"), this.state.error && /*#__PURE__*/React.createElement(Message, {\n        color: \"red\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 17\n        }\n      }, this.state.error), /*#__PURE__*/React.createElement(Form, {\n        onSubmit: this.handleSubmit,\n        size: \"large\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Segment, {\n        stacked: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Form.Input, {\n        name: \"email\",\n        fluid: true,\n        icon: \"user\",\n        iconPosition: \"left\",\n        placeholder: \"E-mail address\",\n        type: \"email\",\n        onChange: this.handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(Form.Input, {\n        name: \"password\",\n        fluid: true,\n        icon: \"lock\",\n        iconPosition: \"left\",\n        placeholder: \"Password\",\n        type: \"password\",\n        onChange: this.handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(Button, {\n        color: \"teal\",\n        fluid: true,\n        size: \"large\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 19\n        }\n      }, \"Login\"))), /*#__PURE__*/React.createElement(Message, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 15\n        }\n      }, \"New to us? \", /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/register\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 28\n        }\n      }, \"Sign Up\")))));\n    }\n  }\n\n}\n\nexport default connect(({\n  user\n}) => ({\n  user: user.user,\n  authenticated: user.authenticated\n}))(Login);","map":{"version":3,"sources":["/Users/oceanegodoy/Documents/ENSEIRB-MATMECA/3A/PADOL/frontend/src/components/auth/login.js"],"names":["React","Component","Button","Form","Grid","Message","Segment","Header","Redirect","ApiClient","Auth","connect","authenticateUser","validateEmail","email","re","test","String","toLowerCase","Login","state","password","loginSuccessful","error","user","authenticated","handleChange","event","target","name","setState","value","validate","Promise","reject","resolve","handleSubmit","self","then","login","res","data","success","saveToken","token","message","catch","e","componentDidMount","props","dispatch","componentWillReceiveProps","nextProps","console","log","render","maxWidth"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  Button,\n  Form,\n  Grid,\n  Message,\n  Segment,\n  Header\n} from \"semantic-ui-react\";\nimport { Redirect } from \"react-router-dom\";\nimport { ApiClient } from \"../../utils/ApiClient\";\nimport Auth from \"../../utils/Auth\";\nimport { connect } from \"react-redux\";\nimport { authenticateUser } from \"../../actions/user\";\n\nfunction validateEmail(email) {\n  var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return re.test(String(email).toLowerCase());\n}\n\nclass Login extends Component {\n  state = {\n    email: null,\n    password: null,\n    loginSuccessful: false,\n    error: null,\n    user: null,\n    authenticated: false\n  };\n\n  componentDidMount() {\n    this.props.dispatch(authenticateUser());\n  }\n\n  componentWillReceiveProps(nextProps) {\n    console.log(\n      \"************ Login page componentWillReceiveProps **************\",\n      nextProps\n    );\n    if (nextProps.authenticated === true) {\n      this.setState({ authenticated: true });\n    }\n  }\n\n  handleChange = event => {\n    const { email, password } = event.target;\n    switch (event.target.name) {\n      case \"email\":\n        this.setState({ email: event.target.value });\n        break;\n      case \"password\":\n        this.setState({ password: event.target.value });\n        break;\n      default:\n        break;\n    }\n  };\n\n  validate = async () => {\n    const { email, password } = this.state;\n    if (!email && !validateEmail(email)) {\n      return Promise.reject(\"Please provide a correct email\");\n    }\n    if (!password) {\n      return Promise.reject(\"Please provide a password\");\n    }\n    return Promise.resolve();\n  };\n\n  handleSubmit = event => {\n    const { email, password, error } = this.state;\n    const self = this;\n    this.validate()\n      .then(() => {\n        ApiClient.login(email, password)\n          .then(res => {\n            if (res.data.success) {\n              Auth.saveToken(res.data.token);\n            }\n            self.setState({\n              loginSuccessful: res.data.success,\n              error: res.data.message\n            });\n          })\n          .catch(e =>\n            this.setState(() => ({\n              error: e.data.message,\n              loginSuccessful: false\n            }))\n          );\n      })\n      .catch(e => {\n        this.setState({ error: e });\n      });\n  };\n\n  render() {\n    const { loginSuccessful, user, authenticated } = this.state;\n\n    if (loginSuccessful || authenticated) {\n      return <Redirect to=\"/account\" />;\n    } else {\n      return (\n        <div className=\"login-form\">\n          {/*\n\t\t\t\t\t\tHeads up! The styles below are necessary for the correct render of this example.\n\t\t\t\t\t\tYou can do same with CSS, the main idea is that all the elements up to the `Grid`\n\t\t\t\t\t\tbelow must have a height of 100%.\n\t\t\t\t\t*/}\n          {/* <style>{`\n\t\t\t\t\t\tbody > div,\n\t\t\t\t\t\tbody > div > div,\n\t\t\t\t\t\tbody > div > div > div.login-form {\n\t\t\t\t\t\t\theight: 70%;\n\t\t\t\t\t\t}\n\t\t\t\t\t`}</style> */}\n          <Grid\n            textAlign=\"center\"\n            // style={{ height: \"100%\" }}\n            verticalAlign=\"middle\"\n          >\n            <Grid.Column style={{ maxWidth: 450 }}>\n              <Header as=\"h3\" textAlign=\"center\">\n                Login form\n              </Header>\n              {this.state.error && (\n                <Message color=\"red\">{this.state.error}</Message>\n              )}\n              <Form onSubmit={this.handleSubmit} size=\"large\">\n                <Segment stacked>\n                  <Form.Input\n                    name=\"email\"\n                    fluid\n                    icon=\"user\"\n                    iconPosition=\"left\"\n                    placeholder=\"E-mail address\"\n                    type=\"email\"\n                    onChange={this.handleChange}\n                  />\n                  <Form.Input\n                    name=\"password\"\n                    fluid\n                    icon=\"lock\"\n                    iconPosition=\"left\"\n                    placeholder=\"Password\"\n                    type=\"password\"\n                    onChange={this.handleChange}\n                  />\n\n                  <Button color=\"teal\" fluid size=\"large\">\n                    Login\n                  </Button>\n                </Segment>\n              </Form>\n              <Message>\n                New to us? <a href=\"/register\">Sign Up</a>\n              </Message>\n            </Grid.Column>\n          </Grid>\n        </div>\n      );\n    }\n  }\n}\n\nexport default connect(({ user }) => ({\n  user: user.user,\n  authenticated: user.authenticated\n}))(Login);\n"]},"metadata":{},"sourceType":"module"}